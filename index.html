<style>
.bar-container {
	margin: 2px 0;
}
</style>

<p>Paste numbers, get bar graph PNGs.
<p><textarea id="numbers" rows="8">10
20
30
50
90
40</textarea>
<hr />
<div id="bars"></div>

<script src="jquery.js"></script>
<script src="pnglib.js"></script>
<script>
var imageData = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAAAAACH5BAAAAAAALAAAAAABAAEAAAICTAEAOw==";
var $numbers = $('#numbers');
var $bars = $('#bars');

$numbers.on('input propertychange', function () {
	var numbers = $(this).val().split('\n').map(function (n) { return parseFloat(n) });
	var min = 0;
	var max = numbers.slice().filter(isFinite).sort(function (a, b) { return b-a })[0];
	var barmin = 3, barmax = 200;
	$bars.empty();
	numbers.forEach(function (n) {
		var $container = $('<div />').addClass('bar-container').appendTo($bars);
		if (isFinite(n)) {
			$container.append(barImage(barmin + (n - min) / (max - min) * (barmax - barmin), 10));
		} else {
			$container.css({ height: 10 });
		}
	});
});
$numbers.trigger('input');

function barImage(width, height) {
	width = Math.max(Math.round(width), 1);
	height = Math.max(Math.round(height), 1);
	var p = new PNGlib(width, height, 256); // construcor takes height, weight and color-depth
	p.color(200, 200, 200, 255); // set the background
	return $('<img />').attr('src', 'data:image/png;base64,'+p.getBase64());
}

</script>
